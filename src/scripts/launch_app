#!/bin/sh

# Directories to search for .desktop files
search_dirs="/usr/share/applications"

# Create an empty list to hold all executable names
executables=""

# Loop through each directory in the search_dirs
for dir in $search_dirs; do
    # Find all .desktop files and extract Exec lines
    for desktop_file in $(find $dir -name '*.desktop'); do
        # Extract the Exec command, remove arguments and field codes
        exec_line=$(grep '^Exec=' "$desktop_file" | head -n 1 | sed 's/^Exec=//' | cut -d ' ' -f 1)

        # Add the executable name to the list if it's not empty
        if [ -n "$exec_line" ]; then
            executables="$executables\n$exec_line"
        fi
    done
done

# Remove duplicates, sort the list, and output to dmenu
echo -e "$executables" | sort -u | dmenu "$@" | ${SHELL:-"/bin/sh"} &
